---
title: 'BelStar 前端团队开发规范'
date: "2020-06-28T16:27:37+08:00"
tags: ["guideline"]
keywords: ["guidlines", "specifications"]
categories: ["Tech"]
dropCap: true
toc: true
slug: "belstar-front-end-team-development-guidelines"
---

规范与制度是开展任何工作都需优先考虑并制定的事务，在软件开发环节中更是尤为重要。如在编码规范问题上，很多开发规范已经成为了编码规范的业界标杆了，比如 [Airbnb 的 JavaScript Style Guide](https://github.com/airbnb/javascript)、[Google Style Guides](https://guide.aotu.io/index.html) 等。

编写一部适合 BelStar 的开发规范是必要且迫切的，此开发规范不只限于编码规范，还包含工作流规范、Git 提交规范、文档规范等一系列内容，以组成 BelStar 开发团队的整体协作规范。制定并严格实施该协作规范将在以下方面形成有利作用：

1. 促进团队协作能力，提高软件开发效率，降低繁杂沟通成本；
2. 实现高度统一的代码风格，提高程序可读性、可维护性；
3. 提升开发人员个人能力，有助于团队人员成长。

## Git 规范
### 工作流规范
目前公司一律采用 Git 作为版本控制工具和代码管理工具，在多人协作、并行开发的情况下，一套完整的项目开发管理工作流就显得尤为重要，工作流采用 [Git Flow](https://github.com/ivan-94/git-guide/blob/master/branch/gitflow.md)，大体分支模型如下：

**master 分支**：主分支，表示一个稳定的发布版本，用于项目最终发布，不可直接进行 `push` 操作。

**develop 分支**：主开发分支，基于 master 分支 checkout，最新的特性及 bug 修复都先提交至该分支。

**feature 分支**：功能开发分支，基于 develop 分支 checkout，用于新功能新需求的开发。
  - 命名规范：`feature_name`，name 为功能名称
  - 生命周期：当功能迭代稳定并通过测试后，合并至 develop 分支，删除该分支

**release 分支**：测试分支，用于提交给测试人员进行功能测试及在本分支进行 bug 修复。

> 🧐🧐🧐🧐🧐🧐🧐🧐TODO: 目前没有采用该项，直接在 develop 上测试并修复bug，待定
  - 命名规范：`release`
  - 生命周期：项目整体提测时创建该分支，开发者修复完 bug 并通过测试后合并到 master 和 develop 分支。

### commit 规范
> ⭐️⭐️⭐️⭐️⭐️⭐️目前未采用，强烈推荐

好的提交信息能提高项目整体质量，格式统一的提交信息可方便代码的 review，同时有利于在后期 CI/CD 中自动生成 CHANGELOG。采用 [Angular 提交信息规范](https://github.com/angular/angular/blob/master/CONTRIBUTING.md#-commit-message-guidelines)，具体要求如下：

- 提交的类型必须为以下之一：
  - feat：一项新功能
  - fix：一个错误修复
  - docs：文档更新（如 API 文档、README 等）
  - style：不影响功能的更改（如格式、缺少符号等）
  - refactor：代码重构，既不修正错误也不添加功能的代码更改
  - perf：帮助提升性能的代码更改
  - test：添加或更改测试内容
  - build：影响项目构建或外部依赖项的更改（如 npm、gulp、webpack 等）
  - ci：项目 CI 配置文件和脚本的更改
  - chore：其它非 src 目录和测试文件的杂项更改
  - revert：撤销之前的 commit
- 提交信息的标题必须有，语言组织应简练易读，一般以..动词..开头，使用..第一人称现在时..，如 `feat: finish login`

为规范 commit 信息的一致性，应使用 [Commitizen](https://github.com/commitizen/cz-cli) 工具协助提交，安装方式如下：

1. 安装 commitizen

  ```s
  $ npm install -g commitizen
  ```
2. 配置 Angular 的 commit message 格式

  ```s
  $ commitizen init cz-conventional-changelog --save --save-exact
  ```

**使用方式**：代码更改后，使用 `$ git cz` 代替 `$ git commit -m` 进行交互式提交。

### 版本规范
项目发布的版本号应依据特定规则迭代，应尽可能符合[语义化版本规范](https://semver.org/lang/zh-CN/)，使得开发人员和用户可以通过版本号了解到版本变更的影响范围，版本号规则递增规则如下：

`主版本号.次版本号.修订号`

1. 主版本号：做了不兼容的 API 修改
2. 次版本号：做了向下兼容的功能性新增
3. 修订号：做了向下兼容的问题修正

## 项目组织规范
### Vue 项目结构
### 脚手架及项目模板

### 工具添加
工具的使用应遵循**减少依赖，避免重复**”的原则，“减少依赖”指如果只使用某个工具库其中一个方法，可按需引入或自定义该方法，不整体安装引入该库，从而减少项目依赖项，“避免重复”指书写工具方法应避免重复造轮子。具体内容如下：

**1. 工具库添加**

工具库应使用已有的成熟库，以下为目前开发团队采用的一些公共库：

- JavaScript 方法库：[Lodash.js](https://lodash.com/)
- 数学计算：[BigNumber.js](https://github.com/MikeMcl/bignumber.js/)
- 日期处理：[Moment.js](https://momentjs.com/)
- 发送电子邮件库：[Nodemailer](https://nodemailer.com/about/)

若需添加新的工具库应与开发小组、项目组讨论，确定适用性更强更广的选择方案，并在成功安装工具库后通知其它开发人员，防止再安装功能相似的工具。

**2. 工具方法添加**

工具方法指开发人员自行编写的函数、类，一般位于项目的 utils 目录下，要使用一个特定方法时，应按照以下顺序进行：

1. 查看已安装的工具库中是否有能完成此功能的库
2. 查看 utils 目录下是否已存在其它开发人员完成的类似工具方法
3. 都没有的情况下，再在 utils 目录下寻找合适的文件进行编写，并且应完善工具方法的文档，描述方法的作用、参数及返回值

## 编码规范
### 语言规范
不同语言的编码规范不同，内容也较多，社区已有沉淀下来的成熟规范，推荐阅读并遵循以下前端编码规范：

- **HTML、CSS**：[Code Guide](https://codeguide.co/)、[Airbnb CSS / Sass Styleguide](https://github.com/airbnb/css)

- **JavaScript**：[Airbnb JavaScript Style Guide](https://github.com/airbnb/javascript)

- **Vue**：
  - 按照 `vue` 生命周期钩子的顺序书写其函数，先写钩子函数，最后写 `methods`
  - 每个 Vue 文件的 `data` 的数量最好不要超过 15 个
  - HTML 中标签属性的值使用双引号而非单引号
  - Vue 组件在 HTML 中采用小写字母的标签使用，如 `<my-components :name="zander"></my-components>`
  - HTML 中不要嵌套 JS 语法，即使只有一行代码也要定义在 `methods` 中
  - 关于 `src/` 内文件的引用都用 `@/` 代替
  - 欢迎补充……
  
### 代码格式化
团队应采用同一种代码风格，代码格式化工具推荐使用 [Prettier](https://prettier.io/)，其支持大部分语言的格式化，如 HTML、CSS、JavaScript、JSON、GraphQL、Markdown 等。

**使用方式**：VSCode 安装插件 Prettier，代码文件中使用快捷键 `Shift + Option + F` 进行快捷格式化。

> 注：Vue 的官方 VSCode 插件 [Vetur](https://vuejs.github.io/vetur/) 的格式化功能也基于 Prettier，因此 Vue 文件的格式化工作采用这两个工具都可。

### 语法检查
语言的语法应有特定约束标准，JavaScript 采用 [ESLint](https://cn.eslint.org/) 工具，此处列举一些重要的语法及代码风格要求：

- 使用空格缩进，2个占位符
- 空行最大数目不超过2行
- 使用 `let` 或 `const` 而不是 `var`
- 尽量使用 `===` 和 `!==`
- 回调函数使用箭头函数
- 行末加分号🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️需确认
- 使用 `async/await` 来避免回调地狱
- 欢迎补充……

### Code Review
> 🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️需确认往后是否需要继续施行 code review 再编写相关内容

## 命名规范
几乎所有的命名都是给人看的，而不是给计算机识别的，因此首要原则是易于理解，让读者能一目了然该命名的含义。尽量采用单词的全拼，而非项目外部读者不清楚的缩写。

### 文件命名
由于 Windows、Mac 操作系统下文件名..不区分大小写..，都会当作小写来处理，因此不建议文件名中包含大写字母，但在 Vue 项目 Vue 组件文件允许使用大写字母开头。

- 尽量使用小写字母命名，使用 `-` 连接

### 变量命名
包括 JavaScript 中的变量及 Vue 文件中的 Data 变量。

- 一律采用小驼峰命名法

### 方法命名

- 小驼峰命名法

- 采用动词或动词短语，如 `sendMessage()`

### API 命名
- 小驼峰命名法

- 因为有 HTTP 动词，所以接口名应为名词，如获取用户列表：`router.get('/users')`，删除用户：`router.delete('/user')`

### CSS Class 命名
CSS 的 Class 命名应做到规则有序，看到类名就明白样式的大概含义和内容，采用 [BEM 命名规范](http://getbem.com/introduction/)，可参考[该文](https://juejin.im/post/5a6c5881518825733201daf7)协助理解，BEM 命名规范要求 Class 名应由以下三部分组成：

- 块级别应有一个命名空间（前缀）

- 后代元素使用 `__` 连接

- 不同版本使用 `--` 连接

常规命名法无法明确 Class 间真实的层级关系：

```html
<div class="article">
  <div class="body">
    <div class="button-primary"></div>
    <div class="button-success"></div>
  </div>
</div>
```

BEM 命名法层级关系明确，避免了繁杂的层级选择写法：

```html
<div class="article">
  <div class="article__body">
    <div class="article__button--primary"></div>
    <div class="article__button--success"></div>
  </div>
</div>
```

但此命名法下的 CSS Class 名存在长度过长的缺点，通过 Less/Sass 等预处理器来编写可大大改善：

```sass
.artice {
  &__body {
    padding: 10px;
  }
  &__button {
    width: 20px;
    &--primary {
      background-color: blue;
    }
    &--success {
      background-color: green;
    }
  }
}
```

## 文档规范
文档包含的内容较为广泛，公司也针对于此开发了 [Platform 文件平台](https://doc.belstar.com.cn/)以统一对文件、文档的集中管理。本 Guidline 中的文档规范只针对开发环节中的相关文档，以下：

### API 文档
**1. Restful**

目前 API 开发语言主要采用 Node.js + Express.js，通过集成 [Swagger](https://swagger.io/) 达到“代码即文档”的目的，给开发者简化文档维护的工作，统一 Restful 接口文档的形式和内容。

**2. GraphQL**

GraphQL 类型 API 采用官方工具 [graphiql](https://github.com/graphql/graphiql) 形成 API 的 Playground 及 Docs 即可。

### 共用组件文档
> 🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️确定目前公用组件管理方式，bit？npm？storybook？

## 测试规范
> 🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️🤔️确定是否需要规范测试流程