---
title: "å‰ç«¯å·¥ç¨‹åŒ–ä¹‹å®šåˆ¶ Vue CLI"
date: "2020-09-22T15:12:22+08:00"
tags: ["Vue", "å‰ç«¯å·¥ç¨‹åŒ–"]
discripion: "å®šåˆ¶Vue CLIï¼Œæ·»åŠ éœ€è¦çš„ä¾èµ–é¡¹ï¼Œè‡ªè¡Œç»„ç»‡é¡µé¢ç­‰"
keywords: ["å®šåˆ¶åŒ–", "è‡ªå®šä¹‰", "Vue CLI"]
categories: ["Tech"]
slug: "custom-vue-cli"
gitinfo: true
comments: true
toc: true
---
## å‰è¨€
æƒ³æ¥ä¹Ÿç®—æ¥æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´åšäº†ï¼Œæ€»æ˜¯åœ¨æœ‰ä¸€äº›æƒ³æ³•çš„æ—¶å€™è¢«å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„äº‹æƒ…æ‰“ä¹±ï¼Œå…·ä½“è¯´æ¥è¯é•¿äº†ï¼Œä¸å¦‚è¿™æ ·æ€»ç»“å§â€”â€”..èŒèƒ½æœ‰å˜..ï¼Œ ..æœ‰å¥½æœ‰å..ã€‚è™½ç„¶èƒ½ç”¨æ¥è‡ªæˆ‘æ”¯é…çš„æ—¶é—´å˜å°‘äº†ï¼Œä½†ä¹Ÿä¸ç®—æ¯«æ— æ”¶è·ï¼Œåˆ—å‡ºå‡ æ¡æœ€è¿‘åšçš„è¿˜ç®—ç³»ç»Ÿæ€§çš„å·¥ä½œï¼š

1. ç¼–å†™äº§å‡ºå›¢é˜Ÿå¼€å‘åä½œè§„èŒƒ
2. å…³äº UI é›¶ä»¶åŒ–çš„æ€è€ƒåŠç®€æŠ¥åˆ†äº«
2. æŠ½ç¦»å°è£…å‰ç«¯å…±ç”¨ç»„ä»¶ï¼Œå‘å¸ƒè‡³ [Storybook](http://eportal-guide.belstar.com.cn/)
3. å®šåˆ¶é€‚ç”¨äºå›¢é˜Ÿçš„ Vue CLI

ä¹‹æ‰€ä»¥è¯´è¿™å‡ ä»¶äº‹æ¯”è¾ƒç³»ç»ŸåŒ–æ˜¯å› ä¸ºæˆ‘ç»Ÿä¸€æŠŠå®ƒä»¬å½’åœ¨äº†**å‰ç«¯å·¥ç¨‹åŒ–**è¿™ä¸€ç±»åˆ«ä¸­ï¼Œç›®çš„éƒ½æ˜¯â€œç»Ÿä¸€å¼€å‘æ¨¡å¼ï¼Œç®€åŒ–å¼€å‘è¿‡ç¨‹â€ã€‚å½“ç„¶ï¼Œå·¥ç¨‹åŒ–è¿™ä¸€è®®ç¨‹å’Œå·¥ä½œå¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œå·¥ç¨‹åŒ–è¿‡ç¨‹ä¸­äº§å‡ºæˆæœæ˜¯ä¸€å›äº‹ï¼Œæ¨å¹¿æ•´ä¸ªå›¢é˜Ÿéµå¾ªå„ Guidelines åˆæ˜¯å¦å¤–ä¸€å›äº‹äº†ã€‚ç´¢æ€§è¿‡ç¨‹ä¸­æ˜¯æœ‰ä¸€äº›æ¯”è¾ƒæœ‰æ„ä¹‰çš„æˆæœå¯ä»¥æ‹¿å‡ºæ¥è®°å½•åˆ†äº«çš„ï¼Œæ¯”å¦‚æœ¬æ–‡è¦è¯¦è¿°çš„**å¦‚ä½•å®šåˆ¶é€‚ç”¨äºè‡ªå·±/å›¢é˜Ÿçš„ Vue CLI**ã€‚

---

[Vue CLI](https://cli.vuejs.org/zh/) ä¸€å®šéƒ½ä¸é™Œç”Ÿäº†ï¼ŒVue å®˜æ–¹æä¾›çš„è„šæ‰‹æ¶å·¥å…·ï¼Œæ˜¯ä¸€å¥—åŒ…å«é›†æˆã€æ„å»ºã€æ’ä»¶é…ç½®ã€å›¾å½¢åŒ–ç­‰åŠŸèƒ½çš„å®Œæ•´å·¥å…·é›†ã€‚å®˜æ–¹è„šæ‰‹æ¶çš„ç›®çš„æ˜¯æ›´è½»é‡æ›´ç®€å•ï¼Œè¿½æ±‚ä½¿ç”¨çš„..å¹¿åº¦..ï¼Œä¹Ÿå°±æ˜¯è¦é€‚ç”¨æ›´å¤šçš„å¼€å‘è€…ï¼Œå½“é¢ä¸´ä¸‹é¢é—®é¢˜æ—¶å°±ç¨æ˜¾æ— åŠ›ï¼Œéœ€è¦å¼€å‘è€…åšæ›´å¤šçš„å·¥ä½œï¼Œç”šè‡³æ˜¯åå¤çš„æ›´å¤šå·¥ä½œï¼š

1. å›¢é˜Ÿå¯¹é¡¹ç›®ç›®å½•ç»“æ„æœ‰ä¸¥æ ¼çš„è§„èŒƒè¦æ±‚
2. å®šåˆ¶åŒ–è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¦‚éœ€è¦ä½¿ç”¨ç‰¹å®šçš„ UI æ¡†æ¶åŠå·¥å…·ç±»åº“
3. é¡¹ç›®é…ç½®æ–‡ä»¶è¾ƒå¤šï¼Œå¦‚ ESLint é…ç½®é¡¹ã€Apollo é…ç½®é¡¹ç­‰
4. é¡¹ç›®å†…åŒ…å«é¢„å®šä¹‰çš„å…±ç”¨ç»„ä»¶
5. æ‡’â€¦â€¦

## å®šåˆ¶ Vue CLI
å®šåˆ¶åŒ–çš„ Vue CLI æ˜¯åŸºäº Vue CLI çš„ï¼Œæ‰€ä»¥å¼€å±•ä¹‹å‰åº”ç¡®ä¿æœ¬åœ°å®‰è£…äº† Vue CLI å¹¶å¯ä»¥ä½¿ç”¨ `$ vue create <porect_name>` å‘½ä»¤æˆåŠŸåˆ›å»ºé¡¹ç›®ã€‚å®ç°çš„åŸç†æ˜¯ [Vue CLI preset](https://cli.vuejs.org/zh/guide/plugins-and-presets.html#preset)ï¼Œå³åœ¨åˆ›å»ºæ–°é¡¹ç›®æ—¶ä½¿ç”¨é¢„å®šä¹‰çš„é…ç½®å’Œè¦ç”¨åˆ°çš„æ’ä»¶ï¼Œè€Œè¿™äº›é¢„å®šä¹‰çš„å†…å®¹æ”¯æŒæ”¾åœ¨ Git ä¸Šï¼ˆåŒ…æ‹¬ GitHubã€GitLab ç­‰ï¼‰ï¼Œä½¿ç”¨è¿œç¨‹ä»“åº“ä¸­çš„ Preset åˆ›å»º Vue é¡¹ç›®æ—¶éœ€è¦åŠ å…¥ç‰¹æ®Šçš„é€‰é¡¹ï¼š

```s
# GitHub
$ vue create --preset <username>/<repo> <vue_project_name>

# GitLab ç§æœ‰æœåŠ¡å™¨
$ vue create --preset gitlab:<my-gitlab-server.com>:<group>/<project_name> --clone <vue_project_name>
```

### åˆå§‹åŒ– Preset ç›®å½•ç»“æ„
ä»¥ GitLab ä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Project å clone åˆ°æœ¬åœ°ï¼Œç¬¬ä¸€æ­¥éœ€è¦åˆå§‹åŒ–é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œä¸€èˆ¬ Preset ç”±ä»¥ä¸‹å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå½“ç„¶åŠ ä¸Š README æ›´å¥½äº†ï¼š

```
.
â”œâ”€ template/
â”‚   â””â”€ ...
â”œâ”€ generator.js
â”œâ”€ preset.json
â”œâ”€ prompts.js
â””â”€ README.md
```

> å¼€å‘çš„æ—¶å€™éœ€è¦é¢‘ç¹åœ°æ‰§è¡Œåˆ›å»ºé¡¹ç›®çš„å‘½ä»¤æ¥æµ‹è¯•æ”¹åŠ¨ï¼Œä½¿ç”¨ Git ä»“åº“æ— ç–‘å¤ªéº»çƒ¦äº†ï¼ŒVue CLI ä¹Ÿæ”¯æŒæ ¹æ®æœ¬åœ°çš„æ–‡ä»¶æ¥åˆ›å»ºé¡¹ç›®ï¼š
>
> ```shell
> $ vue create --preset ./<my_preset> <project_name>
> ```

### æ·»åŠ é¢„å®šä¹‰æ–‡ä»¶
preset.json æ˜¯ä½¿ç”¨ `$ vue create` å‘½ä»¤æ—¶è‡ªåŠ¨ç”Ÿæˆçš„é¢„å®šä¹‰é€‰é¡¹çš„ JSON æ–‡ä»¶ï¼ŒMacOS ä¸­ä½äº `~/.vuerc`ã€‚æ–‡ä»¶ä¸­å®šä¹‰çš„å†…å®¹åœ¨å‘½ä»¤è¡Œä¸­ä¸å†æç¤ºï¼Œæ¯”å¦‚æ‰§è¡Œ `$ rm ~/.vuerc` åˆ é™¤è¯¥æ–‡ä»¶åæ‰§è¡Œ `$ vue create hello` ä¼šæç¤ºæ˜¯å¦ä½¿ç”¨æ·˜å®çš„ NPM é•œåƒæå‡ä¸‹è½½é€Ÿåº¦åŠä½¿ç”¨ Yarn or NPM ä½œä¸ºåŒ…ç®¡ç†å·¥å…·ï¼Œåˆ›å»ºå®Œé¡¹ç›®åæŸ¥çœ‹ .vuerc æ–‡ä»¶çš„å†…å®¹ä¼šæ˜¾ç¤ºé€‰æ‹©çš„å†…å®¹ï¼š

```json
{
  "useTaobaoRegistry": true,
  "packageManager": "yarn"
}
```

å¹¶ä¸”ä¹‹ååˆ›å»ºé¡¹ç›®æ—¶é‡‡ç”¨è¯¥é¢„å®šä¹‰é¡¹ï¼Œä¸å†è¿›è¡Œæç¤ºã€‚æ‰€ä»¥å¯æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å®šä¹‰éœ€è¦æ·»åŠ å“ªäº›æ’ä»¶ï¼Œä»¥åŠä¸€äº›ç®€å•çš„é…ç½®é¡¹ï¼š

```json
{
  "useConfigFiles": true,
  "cssPreprocessor": "sass",
  "plugins": {
    "@vue/cli-plugin-babel": {},
    "@vue/cli-plugin-router": {
      "historyMode": true
    },
    "@vue/cli-plugin-vuex": {},
    "@vue/cli-plugin-eslint": {
      "config": "prettier",
      "lintOn": [ "save", "commit" ]
    }
  }
}
```
### å®šä¹‰æ¨¡æ¿æ–‡ä»¶

`template/` ç›®å½•ç”¨æ¥å®šä¹‰ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»º Vue é¡¹ç›®åç”Ÿæˆçš„ç›®å½•ç»“æ„ï¼Œå³æ¨¡æ¿ï¼Œæ¯”å¦‚æˆ‘ä»¬å›¢é˜Ÿçš„è¦æ±‚çš„ç›®å½•æ˜¯è¿™æ ·çš„ï¼š

```
.
â”œâ”€â”€ build/              # ç”Ÿæˆå‹ç¼©åŒ…
â”œâ”€â”€ public/             # é™æ€èµ„æºï¼Œä¸éœ€è¦ webpack å¤„ç†
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â””â”€â”€ index.html
â””â”€â”€ src/
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ fonts/      # å­—ä½“æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ images/     # å›¾ç‰‡æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ styles/     # reset æ ·å¼ï¼ŒåŠå®šä¹‰çš„å¸¸é‡æ–‡ä»¶ç­‰
â”‚   â”œâ”€â”€ components/     # å…±ç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ base/       # å…¨å±€æ³¨å†Œç»„ä»¶
â”‚   â”œâ”€â”€ layout/         # æ•´ä½“å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ plugins/        # æ’ä»¶æ–‡ä»¶
â”‚   â”œâ”€â”€ filters/        # å…¨å±€è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ router/         # è·¯ç”±åŠæ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ store/          # ç®¡ç† vuex å…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ utils/          # å·¥å…·ç±»å‡½æ•°
â”‚   â”œâ”€â”€ views/          # Vue é¡µé¢
â”‚   â”‚   â””â”€â”€ Home.vue
â”‚   â”œâ”€â”€ App.vue
â”‚   â””â”€â”€ main.js
â”œâ”€â”€ .eslintrc.js        # ESLint é…ç½®
â”œâ”€â”€ .gitignore          # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ .prettierrc.js      # Prettier ä»£ç é£æ ¼é…ç½®
â”œâ”€â”€ babel.config.js     # Babel é…ç½®
â”œâ”€â”€ README.md
â””â”€â”€ vue.config.js       # Webpack é…ç½®
```

template ç›®å½•ä¸‹å®šä¹‰çš„ç›®å½•å’Œéœ€è¦çš„ç›®å½•ä¸€è‡´å³å¯ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š

1. å¦‚æœæ¨¡æ¿ä¸­æ²¡æœ‰å®šä¹‰ Vue CLI æœ¬èº«å°±ä¼šç”Ÿæˆçš„æ–‡ä»¶ï¼Œåˆ™é»˜è®¤é‡‡ç”¨åŸæ¥çš„ï¼Œå¦‚ `view/` ç›®å½•ä¸‹çš„ Home.vue å’Œ About.vue ç­‰ï¼ˆä¹Ÿå¯ä»¥é€‰æ‹©åˆ é™¤æ‰€æœ‰é»˜è®¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä¸‹é¢ä¼šè¯´åˆ°ï¼‰
2. ä»¥ `.` å¼€å¤´çš„æ¨¡æ¿æ–‡ä»¶éœ€è¦å°† `.` æ”¹ä¸º `_`ï¼Œä»¥ `_` å¼€å¤´çš„æ¨¡æ¿æ–‡ä»¶è¦å®šä¹‰æˆ `__`ï¼Œå¦åˆ™æ— æ³•æ­£ç¡®æ¸²æŸ“[^1]
3. ç©ºæ–‡ä»¶å¤¹ä¸ä¼šè¢«æ­£ç¡®æ¸²æŸ“

è¿˜æœ‰ä¸€å¤„è¸©çš„å‘è€—è´¹äº†ä¸å°‘æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬é¡¹ç›®ä¸­æ·»åŠ å¹¶é…ç½®äº† Vuetifyï¼Œéœ€è¦åœ¨ main.js ä¸­å¼•å…¥å¹¶æ³¨å†Œåˆ° Vue å®ä¾‹ä¸­ï¼Œä½†å¦‚æœå°†æ•´ä¸ªæ–‡ä»¶æ›¿æ¢ä¸ºæ–°çš„å†…å®¹ï¼Œä¼šæŠ¥é”™ routerã€store ç­‰..é‡å¤å®šä¹‰..ã€‚ç»éªŒè¯å‘ç°**åœ¨ preset.json ä¸­é¢„å®šä¹‰çš„æ’ä»¶ï¼Œä¸éœ€è¦åœ¨æ¨¡æ¿ä¸‹çš„ main.js ä¸­è‡ªè¡Œå¯¼å…¥å’Œæ³¨å†Œ**ï¼Œåªéœ€è¦æ·»åŠ éœ€è¦çš„å†…å®¹å³å¯ï¼Œå¦‚ï¼š

```js
// è·¯å¾„ï¼štemplate/src/main.js

import Vue from 'vue';
import App from './App.vue';

Vue.config.productionTip = false;

import vuetify from './plugins/vuetify';

new Vue({
  vuetify,
  render: (h) => h(App),
}).$mount('#app');
```

å› ä¸º preset.json ä¸­é¢„å®šä¹‰äº† vue-router å’Œ vuexï¼Œæœ€ç»ˆç”Ÿæˆçš„ main.js æ˜¯å®Œæ•´çš„ï¼š

```js
import Vue from 'vue';
import App from './App.vue';
import store from './store';

Vue.config.productionTip = false;

import vuetify from './plugins/vuetify';
import router from './router';

new Vue({
  store,
  vuetify,
  router,
  render: h => h(App)
}).$mount('#app');
```

### æ‰©å±•ä¾èµ–åŒ…
genarator.js æ–‡ä»¶ç”¨æ¥ä¸ºé¡¹ç›®æ·»åŠ å…¶å®ƒä¾èµ–ï¼Œæ¯”å¦‚ UI æ¡†æ¶ã€å·¥å…·ç±»åº“ç­‰ç­‰ï¼Œæ¸²æŸ“ template æ¨¡æ¿çš„æ“ä½œä¹Ÿéœ€è¦åœ¨è¯¥æ–‡ä»¶å†…å®Œæˆã€‚

æ–‡ä»¶å†…éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°ï¼ŒåŒ…å«ä¸‰ä¸ªå‚æ•°ï¼š

- apiï¼š[generator å®ä¾‹](https://cli.vuejs.org/dev-guide/generator-api.html)ï¼Œå‡½æ•°ä¸­å¯ä»¥æ“ä½œè¯¥å®ä¾‹ï¼Œæ¯”å¦‚æ‰©å±•ä¾èµ–ã€æ£€æŸ¥æ’ä»¶ã€æŸ¥çœ‹ç‰ˆæœ¬ç­‰
- optionsï¼šå®šåˆ¶ Vue CLI æ—¶ä¸äº¤äº’å¼å‘½ä»¤è¡Œç»“åˆä½¿ç”¨ï¼Œæ¥æ”¶ç­”æ¡ˆå‚æ•°
- rootOptionsï¼šé¢„å®šä¹‰çš„æ‰€æœ‰å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ preset.json ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶ä¸”åŒ…å«é¡¹ç›®åç§°ã€src/main.js ä¸­é…ç½®çš„è¯´æ˜ç­‰ï¼š

  ```js
  {
    projectName: 'my-vue',
    useConfigFiles: true,
    cssPreprocessor: 'sass',
    plugins: {
      '@vue/cli-plugin-babel': {},
      '@vue/cli-plugin-router': { historyMode: true },
      '@vue/cli-plugin-vuex': {},
      '@vue/cli-plugin-eslint': { config: 'prettier', lintOn: [Array] },
      '/Users/zander/Desktop/zander-vue-cli': { _isPreset: true, prompts: true }
    },
    'src/main.js': Set(2) { 'router', 'store' }
  }
  ```

**1. æ·»åŠ ä¾èµ–é¡¹**

ä¸ºé¡¹ç›®æ·»åŠ è„šæœ¬å’Œä¾èµ–é¡¹éœ€è¦ä½¿ç”¨ generator å®ä¾‹çš„ [extendPackage()](https://cli.vuejs.org/dev-guide/generator-api.html#extendpackage) æ–¹æ³•ï¼Œå†…å®¹å’Œ package.json æ— å¼‚ï¼Œæ ¹æ®ä¾èµ–çš„ç±»å‹å£°æ˜ NPM åŒ…åå’Œç‰ˆæœ¬å³å¯ï¼Œåˆ›å»ºé¡¹ç›®æ—¶ä¼šè‡ªè¡Œå®‰è£…å£°æ˜çš„ä¾èµ–é¡¹ï¼š

```js
module.exports = (api, options, rootOptions) => {
  api.extendPackage({
    scripts: {
      "serve": "vue-cli-service serve",
      "build": "vue-cli-service build",
      "lint": "vue-cli-service lint"
    },
    dependencies: {
      "vue": "^2.6.11",
      "vuetify": "^2.3.2",
      "@mdi/font": "^5.5.55"
    },
    devDependencies: {
      "@babel/core": "^7.11.4",
      "@babel/preset-env": "^7.11.0",
      "@vue/cli-service": "~4.5.0",
      "vue-cli-plugin-vuetify": "^2.0.5",
      "vuetify-loader": "^1.3.0",
      "sass": "^1.26.10",
      "sass-loader": "^8.0.2"
    }
  });
};
```

**2. æ¸²æŸ“æ¨¡æ¿**

ä½¿ç”¨ [render()](https://cli.vuejs.org/dev-guide/generator-api.html#render) æ–¹æ³•æ¥æ¸²æŸ“ template ä¸­å®šä¹‰çš„æ¨¡æ¿ï¼Œè¯¥æ–¹æ³•å®é™…ä½¿ç”¨ EJS è¿›è¡Œæ¸²æŸ“ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªç›¸å¯¹è·¯å¾„çš„å­—ç¬¦ä¸²ï¼Œä¼šå°†åŸæœ¬çš„ç›®å½•ç›´æ¥æ›¿æ¢ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ hash å¯¹è±¡ï¼Œæ–‡ä»¶å¯¹åº”æ–‡ä»¶æ¥æ¸²æŸ“ï¼ˆä¸èƒ½æ˜¯æ–‡ä»¶å¤¹ï¼‰ï¼Œå†™å¤šä¸ª rander å‡½æ•°çš„è¯ä¾æ¬¡æ‰§è¡Œï¼š

```js
  api.render('./template');

  api.render({
    './.eslintrc.js': './template/_eslintrc.js',
    './.gitignore': './template/_gitignore'
  })
```

**3. ä¿®æ”¹ä¸»æ–‡ä»¶**

ä½¿ç”¨ API åŒæ ·å¯ä»¥å®ç°å¯¹ä¸»æ–‡ä»¶ main.js å†…å®¹çš„ä¿®æ”¹ï¼Œä½†â€¦â€¦å®åœ¨æ˜¯æœ‰äº›å¤æ‚å‘¢ğŸ¤ªï¼Œæ„Ÿå…´è¶£çš„å¯å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://cli.vuejs.org/zh/dev-guide/plugin-dev.html#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%96%87%E4%BB%B6)ï¼Œä¸ªäººè§‰å¾—è¿˜æ˜¯æŒ‰ä¸Šé¢çš„æ–¹å¼åœ¨æ¨¡æ¿é‡Œæ›´æ”¹æ›´æ–¹ä¾¿ï¼Œæ¨èğŸ‰ã€‚

### äº¤äº’å¼å‘½ä»¤è¡Œ
å¾ˆå¤šå‘½ä»¤è¡Œæ“ä½œéƒ½æ¶‰åŠå¯¹è¯çš„æƒ…å¢ƒï¼Œæ¯”å¦‚ Git æ“ä½œã€å„ç§ CLI æ“ä½œï¼Œçœ‹èµ·æ¥æ˜¯æ¯”è¾ƒ Geek çš„ï¼Œå…¶å®ç°åŸç†æ˜¯ Node.js çš„äº¤äº’å¼å‘½ä»¤è¡Œ [Inquirer.js](https://github.com/SBoudrias/Inquirer.js)ã€‚è¦æƒ³è‡ªå®šä¹‰ Vue CLI çš„å¯¹è¯å†…å®¹éœ€è¦ç”¨åˆ° prompts.js æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…åº”å¯¼å‡ºä¸€ä¸ªä¸ `inquirer.prompt()` å‚æ•°ç›¸åŒæ•°æ®ç»“æ„çš„..æ•°ç»„..ï¼Œæ•°ç»„å†…æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä½œä¸ºä¸€ä¸ªå‘½ä»¤è¡Œä¸­çš„é—®é¢˜[^2]ï¼š

```js
module.exports = [
  {
    type: "confirm", // é—®é¢˜ç±»å‹
    name: "vuex", // å­˜å‚¨ç­”æ¡ˆçš„ key
    message: "æ˜¯å¦ä½¿ç”¨ vuex è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†?", // é—®é¢˜çš„å†…å®¹
    default: false, // æœªé€‰æ‹©æ—¶çš„é»˜è®¤å€¼
    choices: [
      {
        name: 'æ˜¯', // é€‰é¡¹
        value: true // é€‰é¡¹å¯¹åº”çš„ value
      },
      {
        name: 'å¦', // é€‰é¡¹
        value: false // é€‰é¡¹å¯¹åº”çš„ value
      }
    ]
  }
]
```

åœ¨å‘½ä»¤è¡Œåˆ›å»ºé¡¹ç›®æ—¶ Preset options é˜¶æ®µä¼šè¿›è¡Œäº¤äº’å¼çš„å¯¹è¯ï¼š

![prompt.png](/images/vue-cli:prompt.png "äº¤äº’å¼å‘½ä»¤è¡Œ")

å½“ç„¶ï¼Œå®Œæˆå¯¹è¯ååº”è¯¥æŒ‰ç…§ä¸åŒçš„ç­”æ¡ˆæ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œä¸Šé¢ genarator.js æ–‡ä»¶ä¸­çš„å‡½æ•°çš„ `options` å‚æ•°å°±èµ·åˆ°ä½œç”¨äº†ï¼Œå¯ä»¥åœ¨å‡½æ•°ä¸­æ‰“å° options å‚æ•°ï¼Œç­”æ¡ˆä»¥ Key-value çš„å½¢å¼ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å†…ï¼š

```json
{ vuex: true }
```

é‚£ä¹ˆå°±å¯ä»¥æ ¹æ®è¯¥å¯¹è±¡ç»“åˆ generator å®ä¾‹çš„å„æ–¹æ³•æ¥æ“ä½œäº†ï¼š

```js
if (options.vuex) {
  api.extendPackage({ // æ·»åŠ ä¾èµ–
    dependencies: {
      "vuex": "^3.4.0"
    }
  })

  api.injectImports(api.entryFile, `import store from './store'`); // main.js ä¸­å¯¼å…¥

  api.render({'./src/store/index.js': './template/store/index.js'}); // æ¸²æŸ“ store æ–‡ä»¶
}

api.render('./template/default'); // é»˜è®¤æ¸²æŸ“çš„å†…å®¹
```

æ­¤æ—¶è™½ç„¶ä½¿ç”¨ `injectImports()` æ–¹æ³•å¯¼å…¥äº† store åˆ° main.jsï¼Œä½†è¿˜æ²¡æœ‰æ³¨å†Œåˆ° Vue å®ä¾‹ä¸­ã€‚å› ä¸º render() çš„å®è´¨æ˜¯é€šè¿‡ EJS æ¥æ¸²æŸ“ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ EJS çš„è¯­æ³•å®ç°æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼š

```js
// è·¯å¾„ï¼štemplate/default/src/main.js
import Vue from 'vue';
import App from './App.vue';

Vue.config.productionTip = false;

import vuetify from './plugins/vuetify';

new Vue({
  vuetify,
  <%_ if (options.vuex) { _%>
  store,
  <%_ } _%>
  render: (h) => h(App),
}).$mount('#app');
```

---

å…¶å®èƒ½è‡ªå®šä¹‰çš„å†…å®¹è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚äºŒæ¬¡å°è£… axiosã€æ·»åŠ  NPM ç§æœçš„ä¾èµ–ç­‰ç­‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘è¿˜æ­£åœ¨åšçš„äº‹æƒ…ï¼ŒğŸš©åç»­å°†è¡¥å……åˆ°æ­¤å¤„~

## References & Resources
1. [github.com/cklwblove/vue-cli3-template | GitHub](https://github.com/cklwblove/vue-cli3-template)
2. [å¦‚ä½•ä½¿ç”¨ vue-cli 3 çš„ preset æ‰“é€ åŸºäº git repo çš„å‰ç«¯é¡¹ç›®æ¨¡æ¿ | SegmentFault](https://segmentfault.com/a/1190000016389996)


[^1]: è§ [Vue CLI | æ–‡ä»¶åçš„è¾¹ç•Œæƒ…å†µ](https://cli.vuejs.org/zh/dev-guide/plugin-dev.html#%E6%96%87%E4%BB%B6%E5%90%8D%E7%9A%84%E8%BE%B9%E7%95%8C%E6%83%85%E5%86%B5)è¯´æ˜ã€‚

[^2]: æ›´å¤šé€‰é¡¹å†…å®¹è§ [Inquirer.js](https://github.com/SBoudrias/Inquirer.js#objects)ã€‚